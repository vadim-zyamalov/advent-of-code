# Идея решения

Решение не моё, а честно стыренное на Реддите.
Но я честно попытался его осознать.

Обозначим решение для $n$ шагов как $f(n)$.

Ключевая идея решения состоит в том, что *S* находится **строго** в центре карты, а соответствующие строка и столбец пустые.
Также пустыми являются края карты.

Это означает, что переход из *S* в любую соседнюю копию карты происходит минимум за $r = \lfloor X / 2 \rfloor$ и максимум за $X$ шагов, где $X$ --- длина стороны карты.
Она кстати, квадратная.

Обратим внимание, что число шагов в условии равно $q \times X + r$.

При $q = 0$ мы находим решение **только** для стартового или любого другого квадрата.
Одного квадрата.

Если же $q = 1$, то, учитывая пустые края и центр (примыкающий к *S*) карты, за $X$ шагов мы доходим до центра одного из квадратов и за $r$ шагов находим число решений в нем.
На момент достижения центра сторона квадрата, ограниченного фронтом потенциальных точек будет иметь длину, которую мы приравняем к $1$, а его площадь, соответственно, также будет равна$1$.
Оставшиеся $r$ шагов обходим квадраты.

Очевидно, что при $q = 2$ мы обойдем 25 квадратов, а фронт на момент достижения центрова будет иметь длину стороны $2$ и площадь $4$.
И так далее.

Таким образом, последовательность $f(r), f(r+X), f(r+2X), \dots$ представляет собой точки на некоторой параболе, которую надо восстановить по трем точкам и найти ее значение в точке $q$.

Подробнее в видео [u/Boojum](https://www.reddit.com/r/adventofcode/comments/18njrqf/2023_day_21_a_diamond_in_the_rough/)
