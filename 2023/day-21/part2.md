# Идея решения

Решение не моё, а честно стыренное на Реддите.
Но я честно попытался его осознать.

Обозначим решение для $n$ шагов как $f(n)$.

Ключевая идея решения состоит в том, что *S* находится **строго** в центре карты, а соответствующие строка и столбец пустые.
Это означает, что $f(n + X)$, где $X$ --- сторона карты, можно представить как переход в условный S соседней копии и поиск решения за $n$ шагов в этой копии.

Число шагов равно $q \times X + r$, где $r = \lfloor X / 2 \rfloor$.
Последовательность $f(r), f(r+X), f(r+2X), \dots$ представляет собой точки на некоторой параболе, которую надо восстановить по трем точкам и найти ее значение в точке $q$.
